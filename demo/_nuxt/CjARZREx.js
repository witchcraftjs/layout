import{ar as I,at as E,aY as V,X as m,Z as X,r as F,j as M,M as Y,O as S,x as g,v,N as Q,y as x,a7 as C,a8 as k,U as p,Q as D,T as j,z as H}from"./DVXjeaI0.js";import{t as Z}from"./DeCVlzJk.js";function q(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function L(e,...t){for(const r of t){const n=e,a=I(E(n),E(r));for(const s of a){const o=n[s],l=r[s];o===void 0?n[s]=l:q(l)&&q(o)?n[s]=L(o,l):l!==void 0&&(n[s]=l)}}return e}function J(e,t=0,{queue:r=!1,index:n=r?0:void 0,leading:a=!0,trailing:s=!0}={}){return V(e,t,{queue:r,index:n,leading:a,trailing:s},!0)}class _{observers=new WeakMap;observer;constructor(){this.observers=new WeakMap,this.observer=new ResizeObserver(t=>{for(const r of t){const{target:n,contentRect:a}=r,s=this.observers.get(n);if(s)for(const o of s)o(a,n)}})}observe(t,r){this.observers.get(t)||this.observers.set(t,new Set),this.observer.observe(t),this.observers.get(t).add(r)}unobserve(t,r){if(!this.observers.get(t))return;const a=this.observers.get(t);a.delete(r),a.size===0&&(this.observer.unobserve(t),this.observers.delete(t))}}typeof ResizeObserver>"u"&&console.warn("You are using a directive that uses a ResizeObserver or are importing something that uses this resize observer in a context (e.g. the server) where ResizeObserver does not exist.");const K=typeof ResizeObserver<"u"?new _:{},W=K,h=new WeakMap,R={fitWidth:!0,margin:"dynamic",enabled:!0},ee=(e,t)=>{U(t),O(t)},z=J(ee),te={mounted(e,{value:t={}}){const r=L({...R},t);r.enabled&&(N(e,r),W.observe(e,z))},updated(e,{value:t={}}){const r=L({...R},t),n=e&&f(e),a=e&&h.get(e).grips,s=n&&n.colCount!==r.colCount;(a&&!r.enabled||s)&&(G(e),W.unobserve(e,z)),(!a&&r.enabled||s)&&(N(e,r),W.observe(e,z))},unmounted(e){h.has(e)&&h.get(e).grips&&(G(e),K.unobserve(e,z))},getSSRProps(){return{}}};function $(e,t,r){const n=f(r),a=Math.max(n.margin,t),s=y(r).findIndex(o=>e===o);n.fitWidth?n.widths.value[s]=`${a/u(r).width*100}%`:n.widths.value[s]=`${a}px`}function u(e){const t=e.getBoundingClientRect();return{x:Math.round(t.x),width:Math.round(t.width)}}function P(e){const t=f(e);t.target||m();let r=y(e)[t.grips.get(t.target)];for(r||m();r?.classList.contains("no-resize");)r=r?.previousElementSibling??null;let n=r?.nextElementSibling??null;if(t.fitWidth)for(;n?.classList.contains("no-resize");)n=n?.nextElementSibling??null;return{col:r,colNext:n}}function re(e){return t=>{const r=f(e);if(!r.isDragging){X(t.target),r.target=t.target,r.isDragging=!0,t.preventDefault(),document.addEventListener("pointerup",r.pointerUpHandler);const{col:n,colNext:a}=P(e);if(n===null||a===null)e.classList.add("resizable-cols-error");else{document.addEventListener("pointermove",r.pointerMoveHandler);const s=u(n);s&&(r.offset=t.pageX-(s.x+s.width))}}}}function ne(e){return t=>{const r=f(e);if(r.isDragging){t.preventDefault();const{col:n,colNext:a}=P(e);if(n!==null){const s=u(n),o=s.width,l=s.x,i=u(a||e),c=i.x+i.width,d=r.margin,b=t.pageX-r.offset;if(r.fitWidth){if(b>l+d&&b<c-d){const w=b-l,B=o-w;if(i.width+B<d){e.classList.add("resizable-cols-error");return}$(n,w,e),$(a,i.width+B,e)}}else if(b>l+d){const w=b-l;$(n,w,e)}O(e)}}}}function A(e){return t=>{const r=f(e);r.isDragging&&(t.preventDefault(),r.isDragging=!1,e.classList.remove("resizable-cols-error"),r.offset=0,delete r.target,document.removeEventListener("pointermove",r.pointerMoveHandler),document.removeEventListener("pointerup",r.pointerUpHandler),document.removeEventListener("pointerleave",r.pointerLeaveHandler))}}function T(){const e=document.createElement("div");return e.style.position="absolute",e.style.cursor="col-resize",e.style.top="0",e.style.bottom="0",e.classList.add("grip"),e}const se=e=>{const t=Array.from(e.querySelectorAll(".grip")??[]);for(const r of t)e.removeChild(r)};function oe(e){const t=T();e.appendChild(t);const r=u(t).width*3;return e.removeChild(t),r}function f(e){const t=h.get(e);return t||m("El went missing."),t}function y(e){const t=h.get(e);return t||m("El went missing."),[...e.querySelectorAll(`:scope ${t.selector?t.selector:"tr > td"}`)]}function N(e,t){const r=oe(e),n={grips:new Map,isDragging:!1,pointerDownHandler:re(e),pointerMoveHandler:ne(e),pointerUpHandler:A(e),pointerLeaveHandler:A(e),fitWidth:t.fitWidth,margin:t.margin==="dynamic"?r:t.margin,colCount:t.colCount,widths:t.widths,selector:t.selector};h.set(e,n);const s=y(e).slice(0,t.colCount);U(e,s),e.style.width=n.fitWidth?"":"min-content";const o=t.colCount;for(let l=0;l<o;l++){if(t.fitWidth&&l===o-1)continue;const i=T();i.addEventListener("pointerdown",n.pointerDownHandler),e.appendChild(i),n.grips.set(i,l)}O(e),e.classList.add("resizable-cols-setup")}function O(e){let t=0;const r=f(e);for(const n of r.grips.keys()){const a=r.grips.get(n),s=y(e)[a];s||m();const o=u(s),l=u(n);n.style.left=`${t+o.width-l.width/2}px`,t+=o.width}}function U(e,t){const r=f(e),n=t??y(e).slice(0,r.colCount),a=r.colCount;let s=0;const o=a*r.margin;for(let l=0;l<a;l++){const i=n[l],c=u(i);$(i,c.width,e),s+=u(i).width}s<o?e.style.minWidth=`${o}px`:e.style.minWidth=""}function G(e){const t=f(e);e.removeEventListener("pointerdown",t.pointerDownHandler),document.removeEventListener("pointermove",t.pointerMoveHandler),document.removeEventListener("pointerup",t.pointerUpHandler);for(const r of Object.keys(t))delete t[r];h.delete(e),e.classList.remove("resizable-cols-setup"),se(e)}const ie={key:0,class:"table--header"},le={class:"table--row"},ae={class:"table--body"},ue=Object.assign({name:"LibTable"},{__name:"WTable",props:{resizable:{type:Object,required:!1,default:()=>({})},values:{type:Array,required:!1,default:()=>[]},itemKey:{type:[String,Number,Symbol,Function],required:!1,default:""},cols:{type:Array,required:!1,default:()=>[]},rounded:{type:Boolean,required:!1,default:!0},border:{type:Boolean,required:!1,default:!0},cellBorder:{type:Boolean,required:!1,default:!0},header:{type:Boolean,required:!1,default:!0},colConfig:{type:Object,required:!1,default:()=>({})}},setup(e){const t=e,r=F([]),n=M(()=>({colCount:t.cols.length,widths:r,selector:".cell",...t.resizable})),a=(o,l,i)=>{const c={bl:!i&&o===t.values.length-1&&l===0,br:!i&&o===t.values.length-1&&l===t.cols.length-1,tr:(i||!t.header)&&o===0&&l===t.cols.length-1,tl:(i||!t.header)&&o===0&&l===0,"first-row":(i||!t.header)&&o===0,"last-row":o===t.values.length-1,"first-col":l===0,"last-col":l===t.cols.length-1};return E(c).filter(d=>c[d])},s=M(()=>Object.fromEntries([...Array(t.values.length+1).keys()].map(o=>[...Array(t.cols.length).keys()].map(l=>[`${o-1}-${l}`,a(o<=0?0:o-1,l,o===0).join(" ")])).flat()));return(o,l)=>Y((g(),v("table",{class:p(S(Z)(`table
		table-fixed
		border-separate
		border-spacing-0
		overflow-x-scroll
		scrollbar-hidden
		[&_.grip]:w-[5px]
		relative
		w-full
		box-content
		[&_thead]:font-bold
		[&_td]:p-1
		[&_td]:overflow-x-hidden
		[&.resizable-cols-error]:cursor-not-allowed
		[&.resizable-cols-error]:user-select-none
		`,e.cellBorder&&`
			[&_td]:border-neutral-500
			[&_td:not(.last-row)]:border-b
			[&_td:not(.first-col)]:border-l
		`,e.border&&`
			[&_thead_td]:bg-neutral-200
			[&_td]:border-neutral-500
			dark:[&_thead_td]:bg-neutral-800
			dark:[&_td]:border-neutral-500
			[&_td.first-row]:border-t
			[&_td.last-row]:border-b
			[&_td.last-col]:border-r
			[&_td.first-col]:border-l
		`,e.rounded&&`
			[&_td.br]:rounded-br-sm
			[&_td.bl]:rounded-bl-sm
			[&_td.tr]:rounded-tr-sm
			[&_td.tl]:rounded-tl-sm
		`,o.$attrs.class))},[e.header?(g(),v("thead",ie,[x("tr",le,[(g(!0),v(C,null,k(e.cols,(i,c)=>D(o.$slots,`header-${i.toString()}`,{key:i,class:p([s.value[`-1-${c}`],"cell table--header-cell",e.colConfig[i]?.resizable===!1?"no-resize":""].join(" ")),style:j(`width:${r.value.length>0?r.value[c]:""}; `),colKey:i},()=>[x("td",{class:p([s.value[`-1-${c}`],"cell table--header-cell",e.colConfig[i]?.resizable===!1?"no-resize":""].join(" ")),style:j(`width:${r.value.length>0?r.value[c]:""}; `)},H(e.colConfig[i]?.name??i),7)])),128))])])):Q("",!0),x("tbody",ae,[(g(!0),v(C,null,k(e.values,(i,c)=>(g(),v("tr",{key:typeof e.itemKey=="function"?e.itemKey(i):i[e.itemKey],class:"table--row"},[(g(!0),v(C,null,k(e.cols,(d,b)=>D(o.$slots,d,{key:(typeof e.itemKey=="function"?e.itemKey(i):i[e.itemKey])+d.toString(),item:i,value:i[d],class:p(s.value[`${c}-${b}`]+"table--cell cell")},()=>[x("td",{class:p(s.value[`${c}-${b}`]+"table--cell cell")},H(i[d]),3)])),128))]))),128))])],2)),[[S(te),n.value]])}});export{ue as default};
