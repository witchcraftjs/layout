import{am as N,v as r,x as o,y as n,r as M,ao as S,Y as W,j as F,N as m,U as I,O as e,Q as V,z as v,P as R,a7 as X,a8 as Y,A as p,B as b,C as q,ap as G}from"./DVXjeaI0.js";import{u as J}from"./Cn0dpc25.js";import{u as K}from"./CJMfQ0aH.js";import{t as g}from"./DeCVlzJk.js";import A from"./CoDCRfl4.js";import Z from"./BOOMfXGw.js";import{g as _}from"./BpX0FRyY.js";import"./Bk2TiR2_.js";import"./yRW9QxNd.js";const ee={style:{"vertical-align":"-0.125em",height:"1em",display:"inline-block",width:"auto"},viewBox:"0 0 384 512"};function te(t,u){return o(),r("svg",ee,[...u[0]||(u[0]=[n("path",{fill:"currentColor",d:"M320 464c8.8 0 16-7.2 16-16V160h-80c-17.7 0-32-14.3-32-32V48H64c-8.8 0-16 7.2-16 16v384c0 8.8 7.2 16 16 16zM0 64C0 28.7 28.7 0 64 0h165.5c17 0 33.3 6.7 45.3 18.7l90.5 90.5c12 12 18.7 28.3 18.7 45.3V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64z"},null,-1)])])}const le=N({name:"fa6-regular-file",render:te}),ie={style:{"vertical-align":"-0.125em",height:"1em",display:"inline-block",width:"auto"},viewBox:"0 0 448 512"};function se(t,u){return o(),r("svg",ie,[...u[0]||(u[0]=[n("path",{fill:"currentColor",d:"M246.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l73.4-73.4V320c0 17.7 14.3 32 32 32s32-14.3 32-32V109.3l73.4 73.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-128-128zM64 352c0-17.7-14.3-32-32-32S0 334.3 0 352v64c0 53 43 96 96 96h256c53 0 96-43 96-96v-64c0-17.7-14.3-32-32-32s-32 14.3-32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32z"},null,-1)])])}const ae=N({name:"fa6-solid-arrow-up-from-bracket",render:se}),ne=["for"],re={key:1,class:"file-input--label-count"},oe={key:0,class:"file-input--formats-label flex flex-col items-center text-sm"},ce={class:"file-input--formats-list"},fe=["id","accept","multiple"],ue={class:"file-input--remove-button flex flex-initial basis-full justify-start"},pe={class:"file-input--preview flex flex-initial basis-full justify-center"},me={key:0,class:"file-input--preview-image bg-transparency-squares flex h-[80px] flex-wrap items-center justify-center"},de=["src"],he={key:1,class:"file-input--preview-no-image flex h-[80px] flex-1 basis-full flex-wrap items-center justify-center"},ve=["title"],ge={name:"LibFileInput"},xe=Object.assign(ge,{name:"LibFileInput",inheritAttrs:!1},{props:{id:{type:String,required:!1},multiple:{type:Boolean,required:!1,default:!1},formats:{type:Array,required:!1,default:()=>["image/*",".jpeg",".jpg",".png"]},compact:{type:Boolean,required:!1,default:!1}},emits:["input","errors"],setup(t,{emit:u}){const d=K(),y=M(null),a=S([]),c=S([]),k=M(!1);W(a,()=>{C("input",a.map(i=>i.file))}),W(c,()=>{c.length>0&&(k.value=!0,setTimeout(()=>{k.value=!1},500),C("errors",c))});const h=J(["wrapper","input","previews"]),C=u,B=_(),x=t,O=F(()=>x.formats?.filter(i=>!i.startsWith("."))??[]),j=F(()=>x.formats?.filter(i=>i.startsWith("."))??[]),T=i=>URL.createObjectURL(i),U=i=>{const s=a.indexOf(i);a.splice(s,1)},E=F(()=>j.value.join(", ")),D=async i=>{if(i.preventDefault(),y.value.files){const s=[];for(const l of y.value.files){const $=l.type.startsWith("image"),H=x.formats.length===0,z=O.value.find(f=>f.endsWith("/*")?l.type.startsWith(f.slice(0,-2)):f===l.type)!==void 0,L=j.value.find(f=>l.name.endsWith(f))!==void 0;if(!H&&(!z||!L)){const f=l.name.match(/.*(\..*)/)?.[1]??"Unknown",P=l.type===""?"":` (${l.type})`,Q=`File type ${f}${P} is not allowed. Allowed file types are: ${E.value}.`,w=new Error(Q);w.file=l,w.isValidExtension=L,w.isValidMimeType=z,s.push(w);continue}s.length>0||a.find(f=>f.file===l)||(x.multiple||a.length<1?a.push({file:l,isImg:$}):a.splice(0,a.length,{file:l,isImg:$}))}if(s.length>0)return c.splice(0,c.length,...s),!1;c.length>0&&c.splice(0,c.length)}};return(i,s)=>(o(),r("div",R({class:e(g)(`file-input
		justify-center
		border-2
		border-dashed
		border-accent-500/80
		focus-outline-within
		transition-[border-color,box-shadow]
		ease-out`,t.compact&&"rounded-sm",!t.compact&&"flex w-full flex-col items-center gap-2 rounded-xl  p-2 ",e(c).length>0&&k.value&&"border-danger-400",e(h).wrapperAttrs.class)},{...e(h).wrapperAttrs,class:void 0}),[n("div",{class:I(e(g)(`
		file-input--wrapper
		relative justify-center`,t.compact&&"flex gap-2",!t.compact&&`input-wrapper
		flex flex-col items-center
		`))},[n("label",{for:t.id??e(B),class:I(e(g)(`
				file-input--label
				pointer-events-none
				flex
				gap-1
				items-center
				whitespace-nowrap
			`))},[t.compact||t.multiple||e(a).length===0?V(i.$slots,"icon",{key:0},()=>[p(A,null,{default:b(()=>[p(e(ae))]),_:1})]):m("",!0),V(i.$slots,"label",{},()=>[q(v(t.compact?t.multiple?e(d)("file-input.compact-choose-file-plural"):e(d)("file-input.compact-choose-file"):t.multiple?e(d)("file-input.non-compact-choose-file-plural"):e(d)("file-input.non-compact-choose-file")),1)]),t.compact&&t.multiple?(o(),r("span",re,v(` (${e(a).length})`),1)):m("",!0)],10,ne),!t.compact&&t.formats?.length>0?(o(),r("label",oe,[V(i.$slots,"formats",{},()=>[q(v(e(d)("file-input.accepted-formats"))+": ",1)]),n("div",ce,v(j.value.join(", ")),1)])):m("",!0),n("input",R({id:t.id??e(B),class:e(g)(`
					file-input--input
					absolute
					inset-0
					z-0
					cursor-pointer
					text-[0]
					opacity-0
				`,e(h).inputAttrs?.class),type:"file",accept:t.formats.join(", "),multiple:t.multiple,ref_key:"el",ref:y},{...e(h).inputAttrs,class:void 0},{onInput:D,onClick:s[0]||(s[0]=l=>l.target.value=null)}),null,16,fe)],2),!t.compact&&e(a).length>0?(o(),r("div",{key:0,class:I(e(g)(`file-input--previews
			flex items-stretch justify-center gap-2 flex-wrap
			`,t.multiple&&`
				w-full
			`,e(h).previewsAttrs?.class))},[s[1]||(s[1]=n("div",{class:"file-input--preview-spacer flex-1"},null,-1)),(o(!0),r(X,null,Y(e(a),l=>(o(),r("div",{class:"file-input--preview-wrapper z-1 relative flex min-w-0 max-w-[150px] flex-initial flex-wrap items-center gap-2 rounded-sm border border-neutral-400 shadow-xs shadow-neutral-800/20",key:l.file.name},[n("div",ue,[p(Z,{border:!1,"aria-label":`Remove file ${l.file.name}`,onClick:$=>U(l)},{default:b(()=>[p(A,null,{default:b(()=>[p(e(G))]),_:1})]),_:1},8,["aria-label","onClick"])]),n("div",pe,[l.isImg?(o(),r("div",me,[n("img",{class:"max-h-full w-auto",src:T(l.file)},null,8,de)])):m("",!0),l.isImg?m("",!0):(o(),r("div",he,[p(A,null,{default:b(()=>[p(e(le),{class:"text-4xl opacity-50"})]),_:1})]))]),n("div",{class:"file-input--preview-filename min-w-0 flex-1 basis-0 truncate break-all rounded-sm p-1 text-sm",title:l.file.name},v(l.file.name),9,ve)]))),128)),s[2]||(s[2]=n("div",{class:"flex-1"},null,-1))],2)):m("",!0)],16))}}),Ae=Object.assign(xe,{__name:"WFileInput"});export{Ae as default};
