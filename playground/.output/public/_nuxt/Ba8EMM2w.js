var ae=Object.defineProperty;var ce=(e,t,s)=>t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var H=(e,t,s)=>ce(e,typeof t!="symbol"?t+"":t,s);import{ay as M,az as de,as as K,a1 as ue,d as fe,r as ve,i as X,R as he,S as N,t as $,v as C,x as O,a9 as R,aa as G,Z as me,X as B,V as be,W as Y,Y as Q,y as Z}from"./Cr7bJNLf.js";function J(e,t,s){switch(e){case"function":return t(s);case"number":return s[t];case"undefined":return"";default:M()}}function ge(e,t=0,{queue:s=!1,index:r=s?0:void 0,leading:a=!1,trailing:i=!0,promisify:n=!1}={}){const l=arguments[3]??!1;let o={};typeof s=="object"&&(o=s);const u=s?typeof r:"undefined";let d;n?d=function(...g){var p,W,E,f,_,L,V;const c=J(u,r,g),T=()=>{var z,k,x;if(i&&((z=o[c])!=null&&z._args)&&((k=o[c])!=null&&k.resolve)){(x=o[c])==null||x.resolve();return}delete o[c]};return o[c]??(o[c]={}),(((p=o[c])==null?void 0:p.timeout)!==void 0||!a)&&(o[c]._args=g,l?(W=o[c]).timeout??(W.timeout=setTimeout(T,t)):(E=o[c])!=null&&E.timeout&&((f=o[c])!=null&&f.reject&&((_=o[c])==null||_.reject(),(L=o[c])==null||delete L.resolve,(V=o[c])==null||delete V.reject),clearTimeout(o[c].timeout))),l||(o[c].timeout=setTimeout(T,t)),new Promise((z,k)=>{var x,I,F;((x=o[c])==null?void 0:x.timeout)===void 0&&a&&(o[c].resolve(),(I=o[c])==null||delete I.resolve,(F=o[c])==null||delete F.reject,l&&(o[c].timeout=setTimeout(T,t))),o[c].resolve=z,o[c].reject=k}).then(async()=>{const z=o[c]._args;return delete o[c],e(...z)}).catch(async()=>e(pe))}:d=function(...v){var g,p,W;const E=this,f=J(u,r,v),_=()=>{var L;i&&((L=o[f])!=null&&L._args)&&e.apply(o[f]._context,o[f]._args),delete o[f]};o[f]||(o[f]={}),((g=o[f])==null?void 0:g.timeout)===void 0&&a?(e.apply(E,v),l&&(o[f].timeout=setTimeout(_,t))):(o[f]._context=E,o[f]._args=v,l?(p=o[f]).timeout??(p.timeout=setTimeout(_,t)):(W=o[f])!=null&&W.timeout&&clearTimeout(o[f].timeout)),l||(o[f].timeout=setTimeout(_,t))};const h=(v="")=>{o[v].timeout&&clearTimeout(o[v].timeout),delete o[v]},b=(v="")=>{var g,p;i&&((g=o[v])!=null&&g._args)&&e.apply((p=o[v])==null?void 0:p._context,o[v]._args),h(v)};return d.cancel=h,d.flush=b,d}const pe=Object.freeze(new Error("Debounced"));function q(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function P(e,...t){for(const s of t){const r=e,a=de(K(r),K(s));for(const i of a){const n=r[i],l=s[i];n===void 0?r[i]=l:q(l)&&q(n)?r[i]=P(n,l):l!==void 0&&(r[i]=l)}}return e}function ye(e,t=0,{queue:s=!1,index:r=s?0:void 0,leading:a=!0,trailing:i=!0}={}){return ge(e,t,{queue:s,index:r,leading:a,trailing:i},!0)}class we{constructor(){H(this,"observers",new WeakMap);H(this,"observer");this.observers=new WeakMap,this.observer=new ResizeObserver(t=>{for(const s of t){const{target:r,contentRect:a}=s,i=this.observers.get(r);if(i)for(const n of i)n(a,r)}})}observe(t,s){this.observers.get(t)||this.observers.set(t,new Set),this.observer.observe(t),this.observers.get(t).add(s)}unobserve(t,s){if(!this.observers.get(t))return;const a=this.observers.get(t);a.delete(s),a.size===0&&(this.observer.unobserve(t),this.observers.delete(t))}}typeof ResizeObserver>"u"&&console.warn("You are using a directive that uses a ResizeObserver or are importing something that uses this resize observer in a context (e.g. the server) where ResizeObserver does not exist.");const re=typeof ResizeObserver<"u"?new we:{},A=re,y=new WeakMap,ee={fitWidth:!0,margin:"dynamic",enabled:!0},_e=(e,t)=>{le(t),U(t)},D=ye(_e),ze={mounted(e,{value:t={}}){const s=P({...ee},t);s.enabled&&(se(e,s),A.observe(e,D))},updated(e,{value:t={}}){const s=P({...ee},t),r=y.has(e)&&y.get(e).grips;r&&!s.enabled&&(oe(e),A.unobserve(e,D)),!r&&s.enabled&&(se(e,s),A.observe(e,D))},unmounted(e){y.has(e)&&y.get(e).grips&&(oe(e),re.unobserve(e,D))},getSSRProps(){return{}}},S=(e,t,s)=>{const r=w(s),a=Math.max(r.margin,t),i=j(s).findIndex(n=>e===n);r.fitWidth?r.widths.value[i]=`${a/m(s).width*100}%`:r.widths.value[i]=`${a}px`},m=e=>{const t=e.getBoundingClientRect();return{x:Math.round(t.x),width:Math.round(t.width)}},ne=e=>{const t=w(e);t.target||M();let s=j(e)[t.grips.get(t.target)];for(s||M();s!=null&&s.classList.contains("no-resize");)s=(s==null?void 0:s.previousElementSibling)??null;let r=(s==null?void 0:s.nextElementSibling)??null;if(t.fitWidth)for(;r!=null&&r.classList.contains("no-resize");)r=(r==null?void 0:r.nextElementSibling)??null;return{col:s,colNext:r}},$e=e=>t=>{const s=w(e);if(!s.isDragging){ue(t.target),s.target=t.target,s.isDragging=!0,t.preventDefault();const{col:r,colNext:a}=ne(e);r===null||a===null?e.classList.add("resizable-cols-error"):document.addEventListener("mousemove",s.mouseMoveHandler);const i=m(r);i&&(s.offset=t.pageX-(i.x+i.width)),document.addEventListener("mouseup",s.mouseUpHandler)}},Ce=e=>t=>{const s=w(e);if(s.isDragging){t.preventDefault();const{col:r,colNext:a}=ne(e);if(r!==null){const i=m(r),n=i.width,l=i.x,o=m(a||e),u=o.x+o.width,d=s.margin,h=t.pageX-s.offset;if(s.fitWidth){if(h>l+d&&h<u-d){const b=h-l,v=n-b;if(o.width+v<d){e.classList.add("resizable-cols-error");return}S(r,b,e),S(a,o.width+v,e)}}else if(h>l+d){const b=h-l;S(r,b,e)}U(e)}}},te=e=>t=>{const s=w(e);s.isDragging&&(t.preventDefault(),s.isDragging=!1,e.classList.remove("resizable-cols-error"),s.offset=0,delete s.target,document.removeEventListener("mousemove",s.mouseMoveHandler),document.removeEventListener("mouseup",s.mouseUpHandler),document.removeEventListener("mouseleave",s.mouseLeaveHandler))},ie=()=>{const e=document.createElement("div");return e.style.position="absolute",e.style.cursor="col-resize",e.style.top="0",e.style.bottom="0",e.classList.add("grip"),e},We=e=>{const t=Array.from(e.querySelectorAll(".grip")??[]);for(const s of t)e.removeChild(s)},Ee=e=>{const t=ie();e.appendChild(t);const s=m(t).width*3;return e.removeChild(t),s},w=e=>{const t=y.get(e);return t||M("El went missing."),t},j=e=>{const t=y.get(e);return t||M("El went missing."),[...e.querySelectorAll(`:scope ${t.selector?t.selector:"tr > td"}`)]},se=(e,t)=>{const s=Ee(e),r={grips:new Map,isDragging:!1,mouseDownHandler:$e(e),mouseMoveHandler:Ce(e),mouseUpHandler:te(e),mouseLeaveHandler:te(e),fitWidth:t.fitWidth,margin:t.margin==="dynamic"?s:t.margin,colCount:t.colCount,widths:t.widths,selector:t.selector};y.set(e,r);const i=j(e).slice(0,t.colCount);le(e,i),e.style.width=r.fitWidth?"":"min-content";const n=t.colCount;for(let l=0;l<n;l++){if(t.fitWidth&&l===n-1)continue;const o=ie();o.addEventListener("mousedown",r.mouseDownHandler),e.appendChild(o),r.grips.set(o,l)}U(e),e.classList.add("resizable-cols-setup")},U=e=>{let t=0;const s=w(e);for(const r of s.grips.keys()){const a=s.grips.get(r),i=m(j(e)[a]),n=m(r);r.style.left=`${t+i.width-n.width/2}px`,t+=i.width}},le=(e,t)=>{const s=w(e),r=t??j(e).slice(0,s.colCount),a=s.colCount;let i=0;const n=a*s.margin;for(let l=0;l<a;l++){const o=r[l],u=m(o);S(o,u.width,e),i+=m(o).width}i<n?e.style.minWidth=`${n}px`:e.style.minWidth=""},oe=e=>{const t=w(e);e.removeEventListener("mousedown",t.mouseDownHandler),document.removeEventListener("mousemove",t.mouseMoveHandler),document.removeEventListener("mouseup",t.mouseUpHandler);for(const s of Object.keys(t))delete t[s];y.delete(e),e.classList.remove("resizable-cols-setup"),We(e)},Le={key:0},Me=fe({name:"lib-table",__name:"LibTable",props:{resizable:{default:()=>({})},values:{default:()=>[]},itemKey:{default:""},cols:{default:()=>[]},rounded:{type:Boolean,default:!0},border:{type:Boolean,default:!0},cellBorder:{type:Boolean,default:!0},header:{type:Boolean,default:!0},colConfig:{default:()=>({})}},setup(e){const t=e,s=ve([]),r=X(()=>({colCount:t.cols.length,widths:s,selector:".cell",...t.resizable})),a=(n,l,o)=>{const u={bl:!o&&n===t.values.length-1&&l===0,br:!o&&n===t.values.length-1&&l===t.cols.length-1,tr:(o||!t.header)&&n===0&&l===t.cols.length-1,tl:(o||!t.header)&&n===0&&l===0,"first-row":(o||!t.header)&&n===0,"last-row":n===t.values.length-1,"first-col":l===0,"last-col":l===t.cols.length-1};return K(u).filter(d=>u[d])},i=X(()=>Object.fromEntries([...Array(t.values.length+1).keys()].map(n=>[...Array(t.cols.length).keys()].map(l=>[`${n-1}-${l}`,a(n<=0?0:n-1,l,n===0).join(" ")])).flat()));return(n,l)=>he(($(),C("table",{class:B(N(be)(`table
		table-fixed
		border-separate
		border-spacing-0
		overflow-x-scroll
		scrollbar-hidden
		[&_.grip]:w-[5px]
		relative
		w-full
		box-content
		[&_thead]:font-bold
		[&_td]:p-1
		[&_td]:overflow-x-hidden
		[&.resizable-cols-error]:cursor-not-allowed
		[&.resizable-cols-error]:user-select-none
		`,n.cellBorder&&`
			[&_td]:border-neutral-500
			[&_td:not(.last-row)]:border-b
			[&_td:not(.first-col)]:border-l
		`,n.border&&`
			[&_thead_td]:bg-neutral-200
			[&_td]:border-neutral-500
			dark:[&_thead_td]:bg-neutral-800
			dark:[&_td]:border-neutral-500
			[&_td.first-row]:border-t
			[&_td.last-row]:border-b
			[&_td.last-col]:border-r
			[&_td.first-col]:border-l
		`,n.rounded&&`
			[&_td.br]:rounded-br
			[&_td.bl]:rounded-bl
			[&_td.tr]:rounded-tr
			[&_td.tl]:rounded-tl
		`,n.$attrs.class))},[n.header?($(),C("thead",Le,[O("tr",null,[($(!0),C(R,null,G(n.cols,(o,u)=>{var d;return Y(n.$slots,`header-${o.toString()}`,{key:o,class:B([i.value[`-1-${u}`],"cell",((d=n.colConfig[o])==null?void 0:d.resizable)===!1?"no-resize":""].join(" ")),style:Q(`width:${s.value.length>0?s.value[u]:""}; `),colKey:o},()=>{var h,b;return[O("td",{class:B([i.value[`-1-${u}`],"cell",((h=n.colConfig[o])==null?void 0:h.resizable)===!1?"no-resize":""].join(" ")),style:Q(`width:${s.value.length>0?s.value[u]:""}; `)},Z(((b=n.colConfig[o])==null?void 0:b.name)??o),7)]})}),128))])])):me("",!0),O("tbody",null,[($(!0),C(R,null,G(n.values,(o,u)=>($(),C("tr",{key:o[n.itemKey]},[($(!0),C(R,null,G(n.cols,(d,h)=>Y(n.$slots,d,{key:o[n.itemKey]+d.toString(),item:o,value:o[d],class:B(i.value[`${u}-${h}`]+" cell")},()=>[O("td",{class:B(i.value[`${u}-${h}`]+" cell")},Z(o[d]),3)])),128))]))),128))])],2)),[[N(ze),r.value]])}});export{Me as default};
